<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Scripting - weka-virtualenv</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Scripting";
    var mkdocs_page_input_path = "scripting.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> weka-virtualenv</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../commands/">Commands</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../extend/">Extend</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../examples/">Examples</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Scripting</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#script-commands">Script commands</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#output-filters">Output filters</a>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../maven/">Maven</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../releases/">Releases</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">weka-virtualenv</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Scripting</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/fracpete/weka-virtualenv/edit/master/docs/scripting.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>With the <code>script</code> command, you can execute simple scripts stored in text
files, enhancing the existing command-line commands with special script 
commands and output filters. Script commands allow you to search for files
or directories, store and remove variables, iterate variable arrays, etc.
Output filters are used to filter the output of commands, e.g., restrict
the information output or redirect it to a file.</p>
<p>Script variables are of the format <code>${name}</code>, with <code>name</code> being the name
of the variable. Environment variables are of the format <code>@{name}</code>. 
Variables get automatically replaced in commands before these get executed.</p>
<p>The following script iterates through all ARFF files in directory 
<code>/home/fracpete/development/datasets/uci/nominal</code>
and cross-validates J48 on it. From the output generated by J48, only
the lines containing <code>Time taken</code>, <code>Correctly Classified</code> and <code>Root mean squared</code>
are filtered out, using the <code>grep</code> filter. This output is then also stored
in the file <code>/home/fracpete/j48.txt</code>, using the <code>tee</code> filter.</p>
<p>In order to make scripts more readable, especially when performing filtering,
long lines can be broken down into multiple ones by ending them all but the
last one with a backslash (<code>\</code>). </p>
<p>Empty lines are skipped, as well as comment lines starting with <code>#</code>.</p>
<pre><code># setup
set searchdir=/home/fracpete/development/datasets/uci/nominal
set outfile=/home/fracpete/j48.txt
set env=weka392

# search for arff files
echo --message &quot;\nsearch dir: ${searchdir}&quot;
list_files --dir ${searchdir} --regexp &quot;.*\.arff&quot; --dest files

# evaluate J48 on each of the arff files and output accuracy in text file
foreach --iterate files --dest file
  echo --message &quot;\n--&gt; ${file}&quot; | tee --stdout --append --output ${outfile}
  run ${env} --class weka.classifiers.trees.J48 -t ${file} \
     | grep --stdout --regexp &quot;.*(Time taken|Correctly Classified|Root mean squared).*&quot; \
     | tee --stdout --append --output ${outfile}
</code></pre>
<h1 id="help">Help</h1>
<p>If you want to get more help on filters, use the following commands:</p>
<ul>
<li><code>filter_help</code> -- outputs a list of all available filters </li>
<li><code>filter_help --filter &lt;name&gt;</code> -- outputs a detailed help screen for the named filter</li>
</ul>
<p>If you want to get more help on script commands, use the following commands:</p>
<ul>
<li><code>script_help</code> -- outputs a list of all available script commands</li>
<li><code>script_help --cmd &lt;name&gt;</code> -- outputs a detailed help screen for the named script command</li>
</ul>
<h2 id="script-commands">Script commands</h2>
<p>The following script commands are available:</p>
<pre><code>Available script commands:

base_name &lt;options&gt;
    Extracts the file name without the path from the specified variable.

calc &lt;options&gt;
    Calculates the result of a mathematical expression.

del_dir &lt;options&gt;
    Deletes the specified directory (recursively).

del_file &lt;options&gt;
    Deletes the specified file.

dir_name &lt;options&gt;
    Extracts the path from the specified file variable.

dump_vars
    Just outputs all the currently set variables.

flatten &lt;options&gt;
    Flattens an array variable into a single string variable.

for &lt;options&gt;
    Iterates through the numeric values from lower to upper bound, using the specified step amount.

foreach &lt;options&gt;
    Iterates through the elements of a variable and executes the nested instructions.

list_dirs &lt;options&gt;
    Locates directories in specified directory and stores them in a variable.
    Search can be recursive, directory names (excl parent path) can be matched again regular expression.

list_files &lt;options&gt;
    Locates files in specified directory and stores them in a variable.
    Search can be recursive, file names (excl path) can be matched again regular expression.

read_lines &lt;options&gt;
    Reads all the lines in a text file into a variable.
    Can skip empty lines and lines that match regular expression.

replace &lt;options&gt;
    Performs string replacement, simple or regular expression based.
    If no replacement string is provided the empty string is used.

replace_ext &lt;options&gt;
    Replaces the extension of the file stored in the variable with the supplied one.

set &lt;args&gt;
    Sets a variable in the form of 'name=value'.
    The value can contain other variables, which will get evaluated in a lazy fashion.

split &lt;options&gt;
    Splits a string variable into a string array variable.

unset &lt;args&gt;
    Removes the specified variable.


Notes:
&lt;options&gt;
    the command supports additional options,
    specify the script's name to output detailed help.
&lt;args&gt;
    the command supports additional arguments
    see script's help.
</code></pre>
<h2 id="output-filters">Output filters</h2>
<p>The following output filters are available:</p>
<pre><code>Available filters:

grep &lt;options&gt;
    For capturing strings that match a regular expression.

replace &lt;options&gt;
    Performs string replacement, simple or regular expression based.

tee &lt;options&gt;
    Tees off the output to a file.


Notes:
&lt;options&gt;
    the filter supports additional options,
    specify the filter's name to output detailed help.
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../maven/" class="btn btn-neutral float-right" title="Maven">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../examples/" class="btn btn-neutral" title="Examples"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/fracpete/weka-virtualenv/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../examples/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../maven/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
